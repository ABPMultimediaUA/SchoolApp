<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Autorizaciones</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/style.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="font-awesome/css/bootstrap-social.css" rel="stylesheet" type="text/css">
    
    <!-- Angular -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script> 

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>
    <header>
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="containerHeader">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="pagUser.html"><img src="img/logoAlpha.png" class="img-responsive " alt="Logotipo" width="100 "></a>
                </div>
                <!-- Collect the nav links, forms, and other content for toggling -->
                <ul class="nav navbar-nav">
                    <li>
                        <a href="#"><span class="glyphicon glyphicon-triangle-left"></span> Volver</a>
                    </li>

                </ul>
                <ul  class="nav navbar-nav navbar-right">
                    <li class="user">
                        <!--Con el enlace se accede a los datos del usuario "Mis Datos"  -->
                        <h3><a href="datos.html"><img src="img/chico.png" class="img-circle" alt="user"></a> MARTÍNEZ GARCÍA, JUAN </h3>
                    </li>
                    <li>
                        <a href="#"><span class="glyphicon glyphicon-log-out"></span> Logout</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
    
    <!-- Page Content -->
    <div class="container">
        <!-- Marketing Icons Section -->
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">
                    AUTORIZACINES
                </h1>
            </div>

            <div class="row">
                <div class="col-lg-10">
                    <h2 class="page-header">
                        Autoriazaciones sin firmar
                    </h2>
                </div>

                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <!--button type="button" class="btn btn-info pull-right" data-toggle="collapse" data-target="#demo">Leído</button-->
                            <input type="button" class="btn btn-default pull-right" value="Ver" onclick="mostrar()">
                            <h4>
                                <a href="#">Autorización 1</a>
                            </h4>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <div class="form-control-static" id="oculto">
                                   <p>Yo padre/madre/tutor-a del alumno-a del curso <b>6ºPRIMERA </b>autorizo a mi hij@ a realizar la actividad <b>Excursión a Terra Mítica</b> el día <b>12/03/2017</b><br> 
                                    Precio de la actividad <b>10€</b><br>
                                    Firmado el día <b>13/03/2017</b><br>
                                    Comentario: Se aconseja llevar almuerzo y gorra. <br><br></p> 
                                    
                                    <form name = "adminForm" ng-submit="firmar()" class="col-xs-2" novalidate >
                                    <!-- SUBMIT BUTTON --> 
                                        <button  type = "submit"  ng-show="!showButton"  class="btn btn-success btn-xs-2 btn-block">
                                            <span class="glyphicon glyphicon-pencil"></span> FIRMAR
                                        </button>
                                    </form>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <input type="button" class="btn btn-default pull-right" value="Ver" onclick="mostrar1()">
                            <h4>
                                <a href="#" class="mensaje">Autorizacion 2</a>
                            </h4>
                            
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <div class="form-control-static" id="oculto1">
                                    <p>Yo padre/madre/tutor-a del alumno-a del curso <b>6ºPRIMERA </b>autorizo a mi hij@ a realizar la actividad <b>Excursión a Terra Mítica</b> el día <b>12/03/2017</b><br> 
                                    Precio de la actividad <b>10€</b><br>
                                    Firmado el día <b>13/03/2017</b><br>
                                    Comentario: Se aconseja llevar almuerzo y gorra.<br><br></p>

                                    <form name = "adminForm" ng-submit="firmar()" class="col-xs-2" novalidate >
                                        <!-- SUBMIT BUTTON --> 
                                        <button  type = "submit"  ng-show="!showButton"  class="btn btn-success btn-xs-2 btn-block">
                                            <span class="glyphicon glyphicon-pencil"></span> FIRMAR
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class = "row">
                <div class="col-lg-10">
                    <h2 class="page-header">
                        Autoriazaciones firmadas
                    </h2>
                </div>

                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                        <input type="button" class="btn btn-default pull-right" value="Ver" onclick="mostrar2()">
                            <h4>
                                <a href="#">Autorizacion 3</a>
                                <!--a href="#" class="btn btn-default pull-right">Leer</a-->
                            </h4>
                        </div>
                        <div class="panel-body">
                            <div class="form-group">
                                <div class="form-control-static" id="oculto2">
                                    <p>Yo padre/madre/tutor-a del alumno-a del curso <b>6ºPRIMERA </b>autorizo a mi hij@ a realizar la actividad <b>Excursión a Terra Mítica</b> el día <b>12/03/2017</b><br> 
                                    Precio de la actividad <b>10€</b><br>
                                    Firmado el día <b>13/03/2017</b><br></p>
                                    Comentario: Se aconseja llevar almuerzo y gorra.<br><br>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12">
                    <p>Copyright &copy; AlphaSchool 2017 - Pagina Web sin animo de lucro</p>
                </div>
            </div>
        </footer>

    </div>
    <!-- /.container -->

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Script to Activate the Carousel -->
    <script>
    $('.carousel').carousel({
        interval: 5000 //changes the speed
    })

    function mostrar(){
        document.getElementById('oculto').style.display = 'inline';
    }

    function mostrar1(){
        document.getElementById('oculto1').style.display = 'inline';
    }

    function mostrar2(){
        document.getElementById('oculto2').style.display = 'inline';
    }
   

    </script>

    <script>
//GET
            var item = sessionStorage.getItem("id");
            if(item!=null){
                document.getElementById("num").value=item;
            } 

            var id=document.getElementById("num").value;
            var id2 = document.getElementById("num").value;
            var aux = document.getElementById("num").value;
            var bool = false;

            if(id == null || id <=0){
                idAu="";
                bool = true;
            }else{
                idAu="id/"+id;
                bool = false;
            }

            var app = angular.module('myApp', []);


                
            app.controller('controlador', function($scope, $http) { 
                $scope.seleccionado = {simple: []};
                if(bool == false){
                    var self = this;
                    $http({
                        url: "http://localhost/prueba_api/alpha2/index.php/comunicado/comunicado/"+idAu+"/format/json", 
                        method: "GET",
                        params: {id: id}
                    })
                     .then(function(response) {
                        self.compuesto = angular.fromJson(response.data);
                        
                        $scope.seleccionado.simple = self.compuesto;

                        if($scope.seleccionado.simple.firmado == "true"){
                            $scope.showButton = true;
                        }else{
                            $scope.showButton = false;
                        }
                    }, function errorCallback(response) {
                        alert()
                    });
                }

                $scope.reload = function() {  
                    sessionStorage.setItem("id", document.getElementById("num").value);
                    location.reload();   
                }


              $scope.json2 = {};
              $scope.salida = {};   
              console.log($scope.seleccionado.simple)
 
              $scope.firmar = function(){
                $scope.seleccionado.simple.firmado = "true";
                $scope.showButton = true;
                $http({
                    method  : 'PUT',
                    url     : 'http://localhost/prueba_api/alpha2/index.php/comunicado/comunicado',
                    data    : $.param($scope.seleccionado.simple),  // pass in data as strings
                    headers : { 'Content-Type': 'application/x-www-form-urlencoded' }  // set the headers so angular passing info as form data (not request payload)
                })
                    .success(function(data) {
                      //Prueba REST /*
                      $scope.json2 = data;
                      if($scope.json2.length == 0){
                       // $scope.salida.texto = $scope.json2[i];
                      };
                      if($scope.json2.length == 1){
                        $scope.salida.texto = $scope.json2[0];
                      };
                      if($scope.json2.length == 2){
                        $scope.salida.texto = $scope.json2[0] + "" + $scope.json2[1] ;
                      };
                      if($scope.json2.length == 3){
                        $scope.salida.texto = $scope.json2[0] + "" + $scope.json2[1] + "" + $scope.json2[2];
                      };
                    }); 

              }


            });

//PUTvar 
    
    app.directive('alias', function() {
            var directive = {};
            directive.restrict = 'E';
            directive.template = "<b>{{alias.texto}}</b>";
            
            directive.scope = {
               alias : "=name"
            }
            return directive;
    });
  </script>

</body>

</html>
