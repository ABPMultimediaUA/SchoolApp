<!doctype html>
<html>
<head>
  <title>Datos Alumno</title>

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/style.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

  <!-- LOAD JQUERY -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  <!-- LOAD ANGULAR -->
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js"></script>

  
        <style>
            .ng-valid.ng-dirty{
                border-color: green;
            }
            .ng-invalid.ng-dirty{
                border-color: red;
            }
        </style>
</head>
<!-- apply the module and controller to our body so angular is applied to that -->
<body  ng-app='myApp' ng-controller='controlador'>
<!--Cabercera-->
<header>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="containerHeader">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="pagUser.html"><img src="img/logoAlpha.png" class="img-responsive " alt="Logotipo" width="80 "></a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <ul class="nav navbar-nav">
                <li>
                    <a href="nosotros.html"><span class="glyphicon glyphicon-triangle-left"></span> Volver</a>
                </li>

            </ul>
            <ul  class="nav navbar-nav navbar-right">
                <li class="user">
                    <h3><img src="img/chico.png" class="img-circle" alt="user">  MARTÍNEZ GARCÍA, JUAN</h3>
                </li>
                <li>
                    <a href="index.html"><span class="glyphicon glyphicon-log-out"></span> Logout</a>
                </li>
            </ul>
        </div>
    </nav>
</header>
    
    <!--Contenido-->
        <div class="container">
            <div class="row">
                <div class="col-lg-12"></br>
                </br>
                    <section id="seccion" >
                        <input type="number" id="num" >
                        <button type="" ng-click="reload()">Consultar</button>  
                    </section>
                    <h1>Mis Datos
                        <small>Datos personales</small>
                    </h1>
                </div>
            </div>

            <!-- Formulario -->
            <form class="form-horizontal col-xs-10" role="form">
                <div class="form-group">
                    <label for="nombre" class="col-xs-2 control-label">Nº Expediente</label>
                    <div class="col-xs-4">
                      <p class="form-control-static">{{seleccionado.simple.idAlumno}}</p>
                    </div>
                </div> 
                <div class="form-group">
                    <label for="nombre" class="col-xs-2 control-label">Nombre</label>
                    <div class="col-xs-4">
                      <p class="form-control-static">{{seleccionado.simple.nombre}}</p>
                    </div>
                </div> 
                <div class="form-group">
                    <label for="apellidos" class="col-xs-2 control-label">Apellidos</label>
                    <div class="col-xs-4">
                        <p class="form-control-static">{{seleccionado.simple.apellidos}}</p>
                    </div>
                </div>
                <div class="form-group">
                    <label for="curso" class="col-xs-2 control-label">Curso</label>
                    <div class="col-xs-4">
                        <p class="form-control-static">{{seleccionado.simple.curso_idCurso}}</p>
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputPassword2" class="col-xs-2 control-label">Email</label>
                    <div class="col-xs-4">
                       <p class="form-control-static">{{seleccionado.simple.email}}</p>
                    </div>
                </div>
                <button type="button" class="btn btn-primary">Error de Datos</button>                
            </form>
        </div>
        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12">
                    <p>Copyright &copy; AlphaSchool 2017 - Pagina Web sin animo de lucro</p>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
        </footer>

<!-- PROCESS FORM WITH AJAX (NEW) -->
  <script>
//GET
            var item = sessionStorage.getItem("user");
            if(item!=null){
                //document.getElementById("num").value=item;
                console.log(item)
            } 

            var id=document.getElementById("num").value;
            var id2 = document.getElementById("num").value;
            var aux = document.getElementById("num").value;
            var bool = false;

            if(id == null || id <=0){
                idAu="";
                bool = true;
            }else{
                idAu="id/"+id;
                bool = false;
            }

            var app = angular.module('myApp', []);


                
            app.controller('controlador', function($scope, $http) { 
                if(bool == false){
                    var self = this;
                    $http({
                        url: "http://localhost/prueba_api/alpha2/index.php/alumno/alumno/"+idAu+"/format/json", 
                        method: "GET",
                        params: {id: id}
                    })
                     .then(function(response) {
                        self.compuesto = angular.fromJson(response.data);
                        $scope.seleccionado = {simple: []};
                        $scope.seleccionado.simple = self.compuesto;

                          console.log($scope.seleccionado.simple)
                      }, function errorCallback(response) {
                        alert()
                    });
                }

                $scope.reload = function() {  
                    sessionStorage.setItem("id", document.getElementById("num").value);
                    location.reload();   
                }


            });




//PUTvar 
    

    app.directive('alias', function() {
            var directive = {};
            directive.restrict = 'E';
            directive.template = "<b>{{alias.texto}}</b>";
            
            directive.scope = {
               alias : "=name"
            }
            return directive;
    });
  </script>
</body>
</html>